{"_id":"1478817694e38dc28abf837c","name":"请假申请","state":"enabled","is_deleted":false,"is_valid":true,"space":"naynKAgLR36DkFrsL","description":"","created":"2017-09-26T06:48:36.941Z","created_by":"5194c66ef4a563537a000003","current":{"_id":"d70cadd8-5c7c-4b29-8923-0e8ff426ddb9","_rev":3,"created":"2017-09-27T08:10:05.952Z","created_by":"5194c66ef4a563537a000003","modified":"2017-09-27T08:25:38.378Z","modified_by":"5194c66ef4a563537a000003","start_date":"2017-09-27T08:10:05.952Z","form":"1478817694e38dc28abf837c","form_script":"CoreForm.pageTitle= \"请假申请\";","name_forumla":"\"请\"+{请假类别}+{tianshu}+\"天\"","fields":[{"_id":"4BDD090A-7254-4E05-9771-A3FB0F15B79C","code":"请假信息","description":"说明：请假天数非自动计算，请手工输入","is_required":false,"is_wide":true,"type":"section","rows":4,"digits":0,"has_others":false,"is_multiselect":false,"is_list_display":false,"is_searchable":false,"oldCode":"请假信息","fields":[{"_id":"684D420B-2DAB-4401-8714-27B5AC6E9DBB","code":"请假类别","default_value":"","is_required":true,"is_wide":false,"type":"select","rows":4,"digits":0,"options":"事假\n病假\n年假\n调休\n婚假\n产假\n产检假\n丧假","has_others":false,"is_multiselect":false,"oldCode":"请假类别","is_list_display":true,"is_searchable":true},{"_id":"051D86ED-2335-4B4D-82DD-79EB4F8369B5","name":"请假天数","code":"tianshu","is_required":true,"is_wide":false,"type":"number","rows":4,"digits":1,"has_others":false,"is_multiselect":false,"oldCode":"tianshu","is_searchable":true},{"_id":"B039BCD4-E682-4FAD-917C-51B72E4B0829","name":"开始时间","code":"starttime","is_required":true,"is_wide":false,"type":"dateTime","rows":4,"digits":0,"has_others":false,"is_multiselect":false,"oldCode":"starttime","is_list_display":true,"is_searchable":false},{"_id":"C7D39D1D-E484-47B8-BAE1-1794D1CB1FA4","name":"结束时间","code":"endtime","is_required":true,"is_wide":false,"type":"dateTime","rows":4,"digits":0,"has_others":false,"is_multiselect":false,"oldCode":"endtime","is_list_display":true,"is_searchable":false},{"_id":"31AEBF53-3395-4312-BC7C-B4A44604E51B","name":"请假事由","code":"note","is_required":true,"is_wide":false,"type":"input","rows":4,"digits":0,"has_others":false,"is_multiselect":false,"oldCode":"note","is_textarea":true,"is_list_display":false,"is_searchable":true}]},{"_id":"B2C99CE3-827A-4BE3-B2FC-330A4EB5C2F4","code":"审批意见","is_required":false,"is_wide":true,"type":"section","rows":4,"digits":0,"has_others":false,"is_multiselect":false,"is_list_display":false,"is_searchable":false,"oldCode":"审批意见","fields":[{"_id":"40122076-CED7-4AC0-8A96-E64F419EE516","code":"部门经理意见","is_required":false,"is_wide":true,"type":"input","rows":4,"digits":0,"formula":"{yijianlan:{step:'部门经理审核',default:'已阅'}}","has_others":false,"is_multiselect":false,"oldCode":"部门经理意见","is_textarea":true,"is_searchable":true},{"_id":"9FB5F1B1-C0E6-4297-9A77-F86C549B360B","name":"总经理意见","code":"总经理意见","is_required":false,"is_wide":true,"type":"input","rows":4,"digits":0,"formula":"{yijianlan:{step:'总经理审批',default:'已阅'}}","has_others":false,"is_multiselect":false,"oldCode":"总经理意见","is_textarea":true,"is_searchable":true}]}]},"enable_workflow":false,"enable_view_others":false,"app":"workflow","category":"a3a3aa3ed7947f4f33e07f84","instance_style":"table","is_subform":false,"import":true,"approve_on_create":false,"approve_on_modify":false,"approve_on_delete":false,"historys":[],"category_name":"人事","instance_number_rules":[],"flows":[{"_id":"11f837e242af3af323639ef5","name":"请假申请","name_formula":"","code_formula":"","space":"naynKAgLR36DkFrsL","is_valid":true,"form":"1478817694e38dc28abf837c","flowtype":"new","state":"enabled","is_deleted":false,"created":"2017-09-26T06:48:36.982Z","created_by":"5194c66ef4a563537a000003","current_no":5,"current":{"_id":"4fa6fac3-8f0a-41a7-94d0-3871902625fb","_rev":3,"flow":"11f837e242af3af323639ef5","form_version":"d70cadd8-5c7c-4b29-8923-0e8ff426ddb9","modified":"2017-09-27T08:25:38.469Z","modified_by":"5194c66ef4a563537a000003","created":"2017-09-27T08:10:05.952Z","created_by":"5194c66ef4a563537a000003","start_date":"2017-09-27T08:10:05.952Z","steps":[{"_id":"6830383D-DB38-4352-A988-E29712A12C92","name":"开始(提交申请)","step_type":"start","deal_type":"","description":"","posx":82,"posy":240,"timeout_hours":168,"approver_user_field":"","approver_org_field":"","approver_roles":[],"approver_orgs":[],"approver_users":[],"approver_step":"","fields_modifiable":[],"permissions":{"qingjialeixing":"editable","请假天数":"editable","开始时间（9:00、12:30）":"editable","结束时间（11:30、18:00）":"editable","请假理由":"editable","__form":"editable","数值":"editable","请假类别":"editable","请假信息":"editable","tianshu":"editable","starttime":"editable","endtime":"editable","note":"editable","审批意见":"editable","文本1":"editable","提交人信息":"editable"},"can_edit_main_attach":false,"can_edit_normal_attach":true,"distribute_optional_flows":[],"lines":[{"_id":"c0c0b021-2e7f-49f6-a67b-8a1a4d8564a2","name":"","state":"submitted","to_step":"dca98bef-0702-4934-ab48-6a8f79f8843c","description":""}],"approver_roles_name":[]},{"_id":"10A03FAF-687A-4C49-B66A-880418C6DAA0","name":"结束","step_type":"end","deal_type":"","description":"","posx":1174,"posy":258,"approver_user_field":"","approver_org_field":"","approver_roles":[],"approver_orgs":[],"approver_users":[],"approver_step":"","fields_modifiable":[],"permissions":{},"distribute_optional_flows":[],"approver_roles_name":[]},{"_id":"83d3b9a3-d876-4983-9d4d-772aa61bcf42","name":"总经理审批","step_type":"sign","deal_type":"applicantRole","description":"","posx":634.0625,"posy":248.0625,"timeout_hours":168,"approver_user_field":"","approver_org_field":"","approver_roles":["ge2aT6ShaY6LdvpFv"],"approver_orgs":[],"approver_users":[],"approver_step":"","fields_modifiable":[],"permissions":{},"disableCC":false,"allowDistribute":false,"can_edit_main_attach":false,"can_edit_normal_attach":true,"distribute_optional_flows":[],"cc_must_finished":false,"cc_alert":false,"lines":[{"_id":"8b6061ac-e492-4feb-b224-8021989cef54","name":"","state":"approved","to_step":"8f1100e3-2b99-4014-b00e-706a610de158","description":""}],"approver_roles_name":["总经理"]},{"_id":"c65c9841-8801-4254-947e-8dff87c08ea0","name":"判断请假天数是否大于3天？","step_type":"condition","deal_type":"","description":"","posx":609,"posy":66,"timeout_hours":168,"approver_user_field":"","approver_org_field":"","approver_roles":[],"approver_orgs":[],"approver_users":[],"approver_step":"","fields_modifiable":[],"permissions":{},"distribute_optional_flows":[],"lines":[{"_id":"967dd23d-795c-4590-90a9-0368b1a8631a","name":"是","state":"submitted","condition":"{tianshu}>1","to_step":"83d3b9a3-d876-4983-9d4d-772aa61bcf42","description":""},{"_id":"82a931e7-aaad-414e-8dc7-ed2834e3a95b","name":"否","state":"submitted","condition":"{tianshu}<=1","to_step":"8f1100e3-2b99-4014-b00e-706a610de158","description":""}],"approver_roles_name":[]},{"_id":"850fdaad-5c8f-487f-a2e4-4f8e9e59e793","name":"通知提交人","step_type":"submit","deal_type":"applicant","description":"","posx":1001,"posy":261,"timeout_hours":168,"approver_user_field":"","approver_org_field":"","approver_roles":[],"approver_orgs":[],"approver_users":[],"approver_step":"","fields_modifiable":[],"permissions":{},"disableCC":false,"allowDistribute":false,"can_edit_main_attach":false,"can_edit_normal_attach":true,"distribute_optional_flows":[],"cc_must_finished":false,"cc_alert":false,"lines":[{"_id":"75a9030f-b5c4-4737-a200-b1054826162e","name":"","state":"submitted","to_step":"10A03FAF-687A-4C49-B66A-880418C6DAA0","description":""}],"approver_roles_name":[]},{"_id":"8f1100e3-2b99-4014-b00e-706a610de158","name":"人事部备案","step_type":"submit","deal_type":"applicantRole","description":"","posx":825,"posy":250,"timeout_hours":168,"approver_user_field":"","approver_org_field":"","approver_roles":["SXfWhiDhM8TBxWrPT"],"approver_orgs":[],"approver_users":[],"approver_step":"","fields_modifiable":[],"permissions":{},"disableCC":false,"allowDistribute":false,"can_edit_main_attach":false,"can_edit_normal_attach":true,"distribute_optional_flows":[],"cc_must_finished":false,"cc_alert":false,"lines":[{"_id":"9b2852c3-faa9-44a6-a892-ca131f4b86f7","name":"","state":"submitted","to_step":"850fdaad-5c8f-487f-a2e4-4f8e9e59e793","description":""}],"approver_roles_name":["人事专员"]},{"_id":"bf09e1b6-5ad9-4c3b-8df9-40471cbb6415","name":"部门经理审核","step_type":"sign","deal_type":"applicantRole","description":"","posx":421,"posy":71,"timeout_hours":168,"approver_user_field":"","approver_org_field":"","approver_roles":["gaY5XFtir2pwTWgjR"],"approver_orgs":[],"approver_users":[],"approver_step":"","fields_modifiable":[],"permissions":{},"disableCC":false,"allowDistribute":false,"can_edit_main_attach":false,"can_edit_normal_attach":true,"distribute_optional_flows":[],"cc_must_finished":false,"cc_alert":false,"lines":[{"_id":"886f3070-a986-423f-822b-48e172940d7a","name":"","state":"approved","to_step":"c65c9841-8801-4254-947e-8dff87c08ea0","description":""}],"approver_roles_name":["部门经理"]},{"_id":"dca98bef-0702-4934-ab48-6a8f79f8843c","name":"判断提交人是否为部门经理？","step_type":"condition","deal_type":"","description":"","posx":260,"posy":227,"timeout_hours":168,"approver_user_field":"","approver_org_field":"","approver_roles":[],"approver_orgs":[],"approver_users":[],"approver_step":"","fields_modifiable":[],"permissions":{},"distribute_optional_flows":[],"lines":[{"_id":"e5c7ea32-5613-48a2-9172-d1c741a9a346","name":"否","state":"submitted","condition":"!({applicant.roles}.contains('部门经理') || {applicant.roles}.contains('办公室主任'))","to_step":"bf09e1b6-5ad9-4c3b-8df9-40471cbb6415","description":""},{"_id":"c5f208cc-97d0-405c-a188-e9aa6ea2d4aa","name":"是","state":"submitted","condition":"({applicant.roles}.contains('部门经理') || {applicant.roles}.contains('办公室主任'))","to_step":"83d3b9a3-d876-4983-9d4d-772aa61bcf42","description":""}],"approver_roles_name":[]}]},"app":"workflow","distribute_optional_users":[],"events":"//如果开始时间大于结束时间，弹出警告，并且不能提交\n$(\"[name='starttime']\").on(\"change\",function(e){\n  if(AutoForm.getFieldValue('endtime', 'instanceform')){\n    var endtime = new Date(AutoForm.getFieldValue('endtime', 'instanceform'));\n    var starttime = new Date($(this).val());\n    if (endtime-starttime<=0)\n        swal(\n\t    {\n\t    title:\"结束时间必须大于开始时间\",\n\t    type:\"warning\",\n\t    confirmButtonText:\"确定\"\n\t    });\n    }\n  }\n)\n$(\"[name='endtime']\").on(\"change\",function(e){\n  if(AutoForm.getFieldValue('starttime', 'instanceform')){\n    var starttime = new Date(AutoForm.getFieldValue('starttime', 'instanceform'));\n    var endtime = new Date($(this).val());\n    if (endtime-starttime<=0)\n        swal(\n\t    {\n\t    title:\"结束时间必须大于开始时间\",\n\t    type:\"warning\",\n\t    confirmButtonText:\"确定\"\n\t    });\n    }\n  }\n)\n\n$(\".instance-form\").on('instance-before-submit', function(e) {\n    if(AutoForm.getFieldValue('starttime', 'instanceform')>=AutoForm.getFieldValue('endtime', 'instanceform'))\n                {\n\t\t\tswal(\n\t\t\t\t    {\n\t\t\t\t    title:\"结束时间必须大于开始时间\",\n\t\t\t\t    type:\"warning\",\n\t\t\t\t    confirmButtonText:\"确定\"\n\t\t\t\t    });\n                        e.preventDefault();\n\t\t\t        }\n}\n )","historys":[]}]}